#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------
# Name: bazel
# Description: bazel
#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------------------------
#
# Begin bazel make targets
#
#--------------------------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------------------------
# bazel clean
#--------------------------------------------------------------------------------------------------------------
bazel/clean:
	./bazelisk clean
	if [ -d "build" ]; then rm -Rf build; fi

#--------------------------------------------------------------------------------------------------------------
# bazel test
#--------------------------------------------------------------------------------------------------------------
bazel/test:
	./bazelisk test ...

#--------------------------------------------------------------------------------------------------------------
# bazel build
#--------------------------------------------------------------------------------------------------------------
bazel/build:
	./bazelisk build ...
	if [ -d "build" ]; then rm -Rf build; fi && mkdir build
	cp bazel-bin/cpp/apps/smoke_test/src/smoke_test build/smoke_test
	cp bazel-bin/cpp/apps/smoke_test/bdd/smoke_test_bdd.so build/smoke_test_bdd.so

#--------------------------------------------------------------------------------------------------------------
# bazel version
#--------------------------------------------------------------------------------------------------------------
bazel/version:
	./bazelisk version
	./bazelisk --version

#--------------------------------------------------------------------------------------------------------------
# bazel lint
#--------------------------------------------------------------------------------------------------------------
bazel/lint:
	buildifier --lint=fix WORKSPACE.bazel
	buildifier --lint=fix cpp/apps/smoke_test/src/BUILD.bazel
	buildifier --lint=fix cpp/apps/smoke_test/test/BUILD.bazel
	buildifier --lint=fix cpp/apps/smoke_test/bdd/BUILD.bazel

#--------------------------------------------------------------------------------------------------------------
#
# End bazel make targets
#
#--------------------------------------------------------------------------------------------------------------
